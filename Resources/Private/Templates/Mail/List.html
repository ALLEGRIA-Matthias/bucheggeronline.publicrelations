<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:be="http://typo3.org/ns/TYPO3/CMS/Backend/ViewHelpers"
      xmlns:c="http://typo3.org/ns/TYPO3/CMS/Core/ViewHelpers"
      xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers"
      v:schemaLocation="https://fluidtypo3.org/schemas/vhs-master.xsd"
      data-namespace-typo3-fluid="true">

<f:layout name="Mailer" />

<f:section name="buttons">
</f:section>

<f:section name="shortcuts">
  <f:link.action action="list" controller="Mail" class="btn btn-sm btn-default"><svg class="icon icon-sm fill-dark"><use xlink:href="{f:uri.resource(path:'Images/', extensionName: 'allegria_communications', useCacheBusting: false)}glyphicons-basics.svg#refresh"></use></svg></f:link.action>
</f:section>

<f:section name="content">
  <h1>Mail Protokoll</h1>
  <f:flashMessages queueIdentifier="allegria.publicrelations.flashMessages" />
  <div class="table-fit">
    <f:render partial="pagination" arguments="{pagination:pagination, actionName:'list'}" />
    <table class="table table-striped table-hover" id="preparedlist">
      <thead>
        <tr>
          <th data-filterable width="150px">Code</th>
          <th data-filterable width="150px">Empf√§nger</th>
          <th data-filterable width="150px">E-Mail</th>
          <th data-filterable>Betreff</th>
          <th data-filterable width="100px">Zeitpunkt</th>
          <th data-sort-method="none" width="30px"></th>
        </tr>
      </thead>
      <tbody id="prepared-to-filter">
        <f:for each="{pagination.paginator.paginatedItems}" as="mail" iteration="i">
        <tr>
          <td>{mail.code}</td>
          <td><f:if condition="{mail.receiver.fullName}"><f:then>{mail.receiver.fullName}</f:then><f:else>{mail.receiver.company}</f:else></f:if></td>
          <td>{mail.email}</td>
          <td>{mail.subject}</td>
          <td data-sort="{mail.sent->f:format.date(format:'%s')}">{mail.sent->f:format.date(format:'%d.%m.%Y %H:%M')}</td>
          <td><be:link.editRecord class="btn btn-sm btn-default" table="tx_publicrelations_domain_model_mail" uid="{mail.uid}" fields="content" returnUrl="{f:uri.action(action:'list', controller:'Mail')}"><svg class="icon icon-sm fill-dark"><use xlink:href="{f:uri.resource(path:'Images/', extensionName: 'allegria_communications', useCacheBusting: false)}glyphicons-basics.svg#eye"></use></svg></be:link.editRecord></td>
        </tr>
        </f:for>
      </tbody>
    </table>
  </div>
</f:section>
</html>
